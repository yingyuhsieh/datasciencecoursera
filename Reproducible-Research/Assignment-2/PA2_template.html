<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Reproducible Research Assignment #2  </title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Reproducible Research Assignment #2  </h1>

<h2>Sunday, September 21, 2014  </h2>

<p>This the assignment #2 of <strong>Reproducible Research Assignment</strong> for <strong>Storm Data Analysis</strong>.  </p>

<hr/>

<h1>Damange Analysis of National Weather Service Storm Data (1950-2011)</h1>

<h2>Synopsis</h2>

<p>To understand the damages (public health and economic problems) for communities and municipalities in different types of natural disasters and events, we explored and ran simple analysis on storm database of the U.S. National Oceanic and Atmospheric Administration (NOAA). The database of NOAA contains records of damages in different types of events from 1950 to 2011.  </p>

<p>In our first data analysis, we filtered and then processed the valid dataset to accumulate the number of fatalities and injuries by different types of events. So, we can understand how these events impact health of people. The second analysis about the economic lost. We accumulate the damage cost (product s and crops) by different types of events.<br/>
The results show hail, thunderstorm and flood are ranked the top natural disasters of health of the citizens. The hurricane, storm and flood are the top threats of economic lost.  </p>

<p><strong>CAVEAT:</strong>
Many records in the database can be either lost or incorrect (human typing error), the valid data are less than 10% of the original data. The analyzed results might not reflect the reality.</p>

<h2>Data Processing</h2>

<pre><code class="r">## load library and declare trim function
library(xtable)
library(ggplot2)
library(R.utils)
</code></pre>

<pre><code>## Loading required package: R.oo
## Loading required package: R.methodsS3
## R.methodsS3 v1.6.1 (2014-01-04) successfully loaded. See ?R.methodsS3 for help.
## R.oo v1.18.0 (2014-02-22) successfully loaded. See ?R.oo for help.
## 
## Attaching package: &#39;R.oo&#39;
## 
## The following objects are masked from &#39;package:methods&#39;:
## 
##     getClasses, getMethods
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     attach, detach, gc, load, save
## 
## R.utils v1.33.0 (2014-08-24) successfully loaded. See ?R.utils for help.
## 
## Attaching package: &#39;R.utils&#39;
## 
## The following object is masked from &#39;package:utils&#39;:
## 
##     timestamp
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     cat, commandArgs, getOption, inherits, isOpen, parse, warnings
</code></pre>

<pre><code class="r">trim &lt;- function (x) gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, x)
</code></pre>

<ol>
<li><p><strong>Load the data:</strong></p>

<ul>
<li><p>Download storm data (<a href="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2">repdata_data_StormData.csv.bz2</a>     ), extract repdata_data_StormData.csv from repdata_data_StormData.csv.bz2 and read dataset.  </p>

<pre><code class="r">library(knitr)
##opts_chunk$set(cache=TRUE)
source_url=&quot;https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2&quot;
source_file=&quot;repdata_data_StormData.csv.bz2&quot;
data_file=&quot;repdata_data_StormData.csv&quot;
## download file and extract file
if (!file.exists(source_file)) {
    ## download repdata_data_StormData.csv.bz2
    download.file(source_url, source_file, method=&quot;curl&quot;, quiet=T)        
}
if (!file.exists(data_file)){
    ## extract bz2 file
    bunzip2(source_file,data_file)
}

## read csv data
data&lt;-read.csv(data_file, sep=&quot;,&quot;, header=T, quote =&quot;&quot;)
</code></pre></li>
</ul></li>
</ol>

<pre><code>- Remove unused rows, empty events, keep (EVTYPE,FATALITIES,INJURIES,PROPDMG,PROPDMGEXP,CROPDMG,CROPDMGEXP) and trim character rows

    ```r
    ## remove unused rows
    wdata &lt;- data[,c(8,23:28)]
    ## trim and set to upper case
    wdata$EVTYPE=toupper(trim(wdata$EVTYPE))
    wdata$PROPDMGEXP=toupper(trim(wdata$PROPDMGEXP))
    wdata$CROPDMGEXP=toupper(trim(wdata$CROPDMGEXP))

    ## remove NA in EVTYPE
    wdata &lt;- subset(wdata,!(wdata$EVTYPE==&quot;&quot; | wdata$EVTYPE==&quot;?&quot;))

    ## transform factor columns to numeric columns
    wdata$FATALITIES &lt;- as.numeric(wdata$FATALITIES)
    wdata$INJURIES &lt;- as.numeric(wdata$INJURIES)
    wdata$PROPDMG &lt;- as.numeric(wdata$PROPDMG)
    wdata$CROPDMG &lt;- as.numeric(wdata$CROPDMG)


    ## remove rows of no damages
    wdata &lt;- subset(wdata,!(wdata$FATALITIES==0 
                  &amp; wdata$INJURIES==0
                  &amp; wdata$PROPDMG==0
                  &amp; wdata$CROPDMG==0))
    ```

- Fix values in PROPDMGEXP and CROPDMGEXP

    ```r
    ## values of PROPDMGEXP &amp; CROPDMGEXP
    ## 0 = 1
    ## H = 100
    ## K = 1000
    ## M = 1000000
    ## B = 1000000000
    ## Others = (unknown or typo, ignore these rows)

    wdata &lt;- subset(wdata, wdata$PROPDMGEXP %in% c(&quot;0&quot;,&quot;H&quot;,&quot;K&quot;,&quot;M&quot;,&quot;B&quot;))
    wdata &lt;- subset(wdata, wdata$CROPDMGEXP %in% c(&quot;0&quot;,&quot;H&quot;,&quot;K&quot;,&quot;M&quot;,&quot;B&quot;))
    ```
</code></pre>

<ol>
<li><p><strong>Process and calculate impact of population health</strong></p>

<ul>
<li>Add new column for total impacted persons</li>
<li>Calculate total impacted persons</li>
<li><p>Aggregate impacted persons by EVTYPE</p>

<pre><code class="r">## add new column TOTAL_PEOPLE to calculate sum op FATALITIES INJURIES
wdata$TOTAL_PEOPLE = wdata$FATALITIES+wdata$INJURIES

## aggregate sum of TOTAL_PEOPLE by different EVTYPE
people_data &lt;- aggregate(TOTAL_PEOPLE~EVTYPE, data=wdata, FUN=sum)
people_data &lt;- people_data[order(people_data$TOTAL_PEOPLE,decreasing=T),]       
</code></pre></li>
</ul></li>
<li><p><strong>Process and calculate damage of products and crops</strong></p>

<ul>
<li>Add new columns for total damage cost</li>
<li>Calculate total damage cost</li>
<li><p>Aggregate total damage cost by EVTYPE</p>

<pre><code class="r">## add new columns PROD_LOST, CROP_LOST, TOTAL_LOST
## calculate total damange of product and crop
wdata$PROD_LOST=wdata$PROPDMG*sapply(wdata$PROPDMGEXP, function(x) {
    if (x==&quot;0&quot;) {1} 
    else if (x==&quot;H&quot;) {100}
    else if (x==&quot;K&quot;) {1000}
    else if (x==&quot;M&quot;) {1000000}
    else if (x==&quot;B&quot;) {1000000000}
})
wdata$CROP_LOST=wdata$CROPDMG*sapply(wdata$CROPDMGEXP, function(x) {
    if (x==&quot;0&quot;) {1} 
    else if (x==&quot;H&quot;) {100}
    else if (x==&quot;K&quot;) {1000}
    else if (x==&quot;M&quot;) {1000000}
    else if (x==&quot;B&quot;) {1000000000}
})
wdata$TOTAL_LOST=wdata$PROD_LOST+wdata$CROP_LOST

## aggregate sum of TOTAL_LOST by different EVTYPE
cost_data &lt;- aggregate(TOTAL_LOST~EVTYPE, data=wdata, FUN=sum)
cost_data &lt;- cost_data[order(cost_data$TOTAL_LOST,decreasing=T),]
</code></pre></li>
</ul></li>
</ol>

<p>##Results
1. <strong>Which types of events are most harmful with respect to population health?</strong>
    - The top types of events and impacted population</p>

<pre><code>```r
names(people_data) &lt;- c(&quot;Event&quot;, &quot;Population&quot;)
xt &lt;- xtable(head(people_data[,1:2],10))
```
&lt;!-- html table generated in R 3.1.1 by xtable 1.7-3 package --&gt;
&lt;!-- Sun Sep 21 22:29:04 2014 --&gt;
&lt;TABLE border=1&gt;
&lt;TR&gt; &lt;TH&gt; Event &lt;/TH&gt; &lt;TH&gt; Population &lt;/TH&gt;  &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; THUNDERSTORM WIND &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 104577212.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; HAIL &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 102678960.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; FLASH FLOOD &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 27772011.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; FLOOD &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 17395616.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; HIGH WIND &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 14764116.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; TORNADO &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 12155447.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; WINTER STORM &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 8623869.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; WINTER WEATHER &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 8554175.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; HEAVY SNOW &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 7723498.00 &lt;/TD&gt; &lt;/TR&gt;
  &lt;TR&gt; &lt;TD&gt; MARINE THUNDERSTORM WIND &lt;/TD&gt; &lt;TD align=&quot;right&quot;&gt; 7463292.00 &lt;/TD&gt; &lt;/TR&gt;
   &lt;/TABLE&gt;

&amp;nbsp;
- Diagram of fatalities and injuries of different types of events

```r
hplot &lt;- ggplot(data=people_data[1:10,], 
                aes(x=reorder(Event,-Population), y=Population)) + 
    geom_bar(stat=&quot;identity&quot;, colour=&quot;grey&quot;, fill=&quot;grey&quot;,
             position=position_dodge()) +
    theme(axis.text.x=element_text(angle=90,hjust=1)) +
    xlab(&quot;&quot;) + ylab(&quot;Fatalities &amp; Injuries&quot;)
print(hplot)
```

![plot of chunk unnamed-chunk-6](figure/unnamed-chunk-6.png) 
</code></pre>

<ol>
<li><p><strong>Which types of events have the greatest economic consequences?</strong></p>

<ul>
<li>The top types of events and economic lost</li>
</ul>

<pre><code class="r">names(cost_data) &lt;- c(&quot;Event&quot;, &quot;Lost&quot;)
xt &lt;- xtable(head(cost_data[,1:2],10))
</code></pre>

<!-- html table generated in R 3.1.1 by xtable 1.7-3 package -->

<!-- Sun Sep 21 22:29:05 2014 -->

<TABLE border=1>
<TR> <TH> Event </TH> <TH> Lost </TH>  </TR>
  <TR> <TD> HURRICANE/TYPHOON </TD> <TD align="right"> 8189779133000.00 </TD> </TR>
  <TR> <TD> FLOOD </TD> <TD align="right"> 3971670213000.00 </TD> </TR>
  <TR> <TD> TORNADO </TD> <TD align="right"> 2990824695059.00 </TD> </TR>
  <TR> <TD> HURRICANE </TD> <TD align="right"> 2439859255000.00 </TD> </TR>
  <TR> <TD> STORM SURGE/TIDE </TD> <TD align="right"> 1449729680000.00 </TD> </TR>
  <TR> <TD> FLASH FLOOD </TD> <TD align="right"> 1356521078588.00 </TD> </TR>
  <TR> <TD> HAIL </TD> <TD align="right"> 1300279192384.00 </TD> </TR>
  <TR> <TD> HURRICANE OPAL </TD> <TD align="right"> 946497000000.00 </TD> </TR>
  <TR> <TD> ICE STORM </TD> <TD align="right"> 845990155629.00 </TD> </TR>
  <TR> <TD> DROUGHT </TD> <TD align="right"> 820019605000.00 </TD> </TR>
   </TABLE>

<p>&nbsp;</p>

<ul>
<li>Diagram of economic lost of different types of events</li>
</ul>

<pre><code class="r">hplot &lt;- ggplot(data=cost_data[1:10,], 
                aes(x=reorder(Event,-Lost), y=Lost)) + 
    geom_bar(stat=&quot;identity&quot;, colour=&quot;grey&quot;, fill=&quot;grey&quot;,
             position=position_dodge()) +
    theme(axis.text.x=element_text(angle=90,hjust=1)) +
    xlab(&quot;&quot;) + ylab(&quot;Economic Lost&quot;)
print(hplot)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p></li>
</ol>

</body>

</html>
